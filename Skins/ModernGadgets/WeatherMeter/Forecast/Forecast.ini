[Rainmeter]
MiddleMouseDownAction=[!Refresh]
MouseOverAction=[!ShowMeterGroup ConfigButton][!UpdateMeterGroup ConfigButton][!UpdateMeterGroup Background][!Redraw]
MouseLeaveAction=[!HideMeterGroup ConfigButton][!UpdateMeterGroup ConfigButton][!UpdateMeterGroup Background][!Redraw]
Group=ModernGadgets | MgGlobalRefresh | MgImportRefresh | MgWeatherMeter
AccurateText=1

[Metadata]
Name=Forecast
Author=raiguard
Information=Seven-day forecast for Weather Meter.
License=Creative Commons Attribution-NonCommercial-ShareAlike 3.0
Version=1.5.0-beta.9

[Variables]
@includeStyleSheet=#@#StyleSheet.inc
@includeGlobalSettings=#@#Settings\GlobalSettings.inc
@includeGadgetSettings=#@#Settings\WeatherSettings.inc

bgHeight=500
bgWidth=370
contentMarginAbs=4

moonRadius=20
moonBorderThickness=3
moonInnerRadius=(#moonRadius# - #moonBorderThickness#)
showMoonAngle=0
colorSkyDialBg=150,150,150
colorSkyDialSun=250,222,110
colorSkyDialMoon=180,180,180

colorMoon=200,200,200
colorMoonBg=30,30,30
colorMoonBorder=70,70,70

chartObjectRadius=4
chartRadius=30
chartArcThickness=2

; JSMorley's WxDataWeatherRegExp.inc
; #region
UnitsOfMeasure=(?siU)<head>.*<locale>(.*)</locale>.*<form>(.*)</form>.*<ut>(.*)</ut>.*<ud>(.*)</ud>.*<us>(.*)</us>.*<up>(.*)</up>.*<ur>(.*)</ur>.*</head>
Location=(?siU)<loc id="(.*)".*<dnam>(.*)</dnam>.*<tm>(.*)</tm>.*<lat>(.*)</lat>.*<lon>(.*)</lon>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>.*<zone>(.*)</zone>.*</loc>
CurrentConditions=(?siU)<cc>.*<lsup>(.*)</lsup>.*<obst>(.*)</obst>.*<tmp>(.*)</tmp>.*<flik>(.*)</flik>.*<t>(.*)</t>.*<icon>(.*)</icon>
CurrentBarometric=(?siU)<cc>.*<bar>.*<r>(.*)</r>.*<d>(.*)</d>.*</bar>
CurrentWind=(?siU)<cc>.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
CurrentElements=(?siU)<cc>.*<hmid>(.*)</hmid>.*<vis>(.*)</vis>.*<uv>.*<i>(.*)</i>.*<t>(.*)</t>.*</uv>.*<dewp>(.*)</dewp>.*<moon>.*<icon>(.*)</icon>.*<t>(.*)</t>.*</moon>.*</cc>
TodayGeneral=(?siU)<dayf>.*<lsup>(.*)</lsup>.*<day d="0".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
TodayDayConditions=(?siU)<day d="0".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>.*</part>
TodayDayWind=(?siU)<day d="0".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>.*</part>
TodayDayElements=(?siU)<day d="0".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
TodayNightConditions=(?siU)<day d="0".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>.*</part>
TodayNightWind=(?siU)<day d="0".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>.*</part>
TodayNightElements=(?siU)<day d="0".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
TodayGeneral=(?siU)<dayf>.*<lsup>(.*)</lsup>.*<day d="0".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
TodayDayConditions=(?siU)<day d="0".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>.*</part>
TodayDayWind=(?siU)<day d="0".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>.*</part>
TodayDayElements=(?siU)<day d="0".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
TodayNightConditions=(?siU)<day d="0".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>.*</part>
TodayNightWind=(?siU)<day d="0".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>.*</part>
TodayNightElements=(?siU)<day d="0".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day1General=(?siU)<day d="1".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
Day1DayConditions=(?siU)<day d="1".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day1DayWind=(?siU)<day d="1".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day1DayElements=(?siU)<day d="1".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day1NightConditions=(?siU)<day d="1".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day1NightWind=(?siU)<day d="1".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day1NightElements=(?siU)<day d="1".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day2General=(?siU)<day d="2".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
Day2DayConditions=(?siU)<day d="2".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day2DayWind=(?siU)<day d="2".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day2DayElements=(?siU)<day d="2".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day2NightConditions=(?siU)<day d="2".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day2NightWind=(?siU)<day d="2".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day2NightElements=(?siU)<day d="2".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day3General=(?siU)<day d="3".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
Day3DayConditions=(?siU)<day d="3".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day3DayWind=(?siU)<day d="3".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day3DayElements=(?siU)<day d="3".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day3NightConditions=(?siU)<day d="3".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day3NightWind=(?siU)<day d="3".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day3NightElements=(?siU)<day d="3".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day4General=(?siU)<day d="4".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
Day4DayConditions=(?siU)<day d="4".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day4DayWind=(?siU)<day d="4".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day4DayElements=(?siU)<day d="4".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day4NightConditions=(?siU)<day d="4".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day4NightWind=(?siU)<day d="4".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day4NightElements=(?siU)<day d="4".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day5General=(?siU)<day d="5".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
Day5DayConditions=(?siU)<day d="5".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day5DayWind=(?siU)<day d="5".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day5DayElements=(?siU)<day d="5".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day5NightConditions=(?siU)<day d="5".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day5NightWind=(?siU)<day d="5".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day5NightElements=(?siU)<day d="5".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day6General=(?siU)<day d="6".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
Day6DayConditions=(?siU)<day d="6".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day6DayWind=(?siU)<day d="6".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day6DayElements=(?siU)<day d="6".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day6NightConditions=(?siU)<day d="6".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day6NightWind=(?siU)<day d="6".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day6NightElements=(?siU)<day d="6".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day7General=(?siU)<day d="7".*t="(.*)".*dt="(.*)".*<hi>(.*)</hi>.*<low>(.*)</low>.*<sunr>(.*)</sunr>.*<suns>(.*)</suns>
Day7DayConditions=(?siU)<day d="7".*<part p="d">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day7DayWind=(?siU)<day d="7".*<part p="d">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day7DayElements=(?siU)<day d="7".*<part p="d">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
Day7NightConditions=(?siU)<day d="7".*<part p="n">.*<icon>(.*)</icon>.*<t>(.*)</t>
Day7NightWind=(?siU)<day d="7".*<part p="n">.*<wind>.*<s>(.*)</s>.*<gust>(.*)</gust>.*<d>(.*)</d>.*<t>(.*)</t>.*</wind>
Day7NightElements=(?siU)<day d="7".*<part p="n">.*<bt>(.*)</bt>.*<ppcp>(.*)</ppcp>.*<hmid>(.*)</hmid>.*</part>
; #endregion

[StyleStringWeather]
Group=Weather

[StyleStringDayHeader]
X=(#contentMargin# + 10)
Y=5R

[StyleStringCondition]
; FontColor=200,200,200
FontSize=9
FontWeight=600
X=5R
Y=-2r

[StyleStringDetail]
X=r
Y=-2R
InlinePattern=".*\: "
InlineSetting=Color | 200,200,200

[StyleConditionIcon]
X=(#contentMargin# + 10)
Y=5R
W=50
H=50
Group=Weather
DynamicVariables=1
Antialias=1
TransformationMatrix=#transformationMatrix#

[StyleMoonShape]
Shape=Ellipse #moonRadius#,#moonRadius#,#moonRadius#,#moonRadius# | StrokeWidth 0 | Fill Color #colorMoonBorder#
Shape2=Ellipse #moonRadius#,#moonRadius#,#moonInnerRadius#,#moonInnerRadius# | StrokeWidth 0 | Fill Color #colorMoonBg#
Shape3=Path MoonArc | StrokeWidth 0 | Fill Color #colorMoon# | Offset #moonBorderThickness#,#moonBorderThickness# | StrokeLineJoin Round | Extend LimbRotation
MoonArc=0,#moonInnerRadius# | ArcTo (#moonInnerRadius# * 2),#moonInnerRadius#,#moonInnerRadius#,[MeasureMoonShapePhaseCalc:],0,((([&MeasureSunCalcScript:GetData('moonPhase')] > 0.25) && ([&MeasureSunCalcScript:GetData('moonPhase')] < 0.75)) ? 1 : 0) | ArcTo 0,#moonInnerRadius#,#moonInnerRadius#,#moonInnerRadius#,0,1
LimbRotation=Rotate ((#showMoonAngle# = 1) ? (-[&MeasureSunCalcScript:GetData('moonViewAngle')]) : (([&MeasureSunCalcScript:GetData('moonPhase')] > 0.5) ? -90 : 90)),#moonInnerRadius#,#moonInnerRadius#
X=(#contentMarginRight# - (#moonRadius# * 2) - 8)
DynamicVariables=1
Group=Weather
TransformationMatrix=#transformationMatrix#

[StyleSunMoonAltitudeChart]
Shape=Arc #chartObjectRadius#,(#chartRadius# + #chartObjectRadius#),(#chartRadius# + #chartObjectRadius#),#chartObjectRadius#,#chartRadius#,#chartRadius# | Stroke Color #colorSkyDialBg# | StrokeWidth (#chartArcThickness# * #scale#) | StrokeStartCap Round | StrokeEndCap Round
Shape2=Path Boundaries | StrokeWidth (#scale# * 2) | Stroke Color #colorSkyDialBg#,120 | StrokeDashes 2,1.5 | StrokeDashCap Round
Boundaries=#chartObjectRadius#,(#chartRadius# + #chartObjectRadius#) | LineTo (#chartRadius# + #chartObjectRadius#),(#chartRadius# + #chartObjectRadius#) | LineTo (#chartRadius# + #chartObjectRadius#),#chartObjectRadius#
Shape3=Ellipse #chartObjectRadius#,(#chartRadius# + #chartObjectRadius#),#chartObjectRadius# | StrokeWidth (1 * #scale#) | Stroke Color #colorBg# | Fill Color #colorSkyDialMoon# | Extend MoonRotation
Shape4=Ellipse #chartObjectRadius#,(#chartRadius# + #chartObjectRadius#),#chartObjectRadius# | StrokeWidth (1 * #scale#) | Stroke Color #colorBg# | Fill Color #colorSkyDialSun# | Extend SunRotation
Shape5=Line #chartObjectRadius#,(#chartRadius# + #chartObjectRadius#),(#chartRadius# + #chartObjectRadius#),(#chartRadius# + #chartObjectRadius#) | StrokeWidth (#scale# * 2) | Stroke Color #colorSkyDialMoon# | StrokeStartCap Round | StrokeEndCap Round | StrokeDashes 2,1.5 | StrokeDashCap Round | Extend MoonLineRotation
Shape6=Line #chartObjectRadius#,(#chartRadius# + #chartObjectRadius#),(#chartRadius# + #chartObjectRadius#),(#chartRadius# + #chartObjectRadius#) | StrokeWidth (#scale# * 2) | Stroke Color #colorSkyDialSun# | StrokeStartCap Round | StrokeEndCap Round | StrokeDashes 2,1.5 | StrokeDashCap Round | Extend SunLineRotation
X=(#contentMarginRight# - (#chartRadius# + #chartObjectRadius#) - 12)
Y=-26r
DynamicVariables=1
Group=SunCalc | Weather
TransformationMatrix=#transformationMatrix#

; ==================================================
;  MEASURES
; ==================================================

; ----- SunCalc Script -----

[MeasureLocalTime]
Measure=Time
; TimeStamp=2018-10-17T00:00:01Z
; TimeStampFormat=%Y-%m-%dT%H:%M:%SZ
Format="%Y-%m-%d %I:%M:%S %p"
UpdateDivider=60
Group=Weather
Disabled=1

; ----- Date and Time Formats -----

[MeasureWinShortTimeFormat]
Measure=Registry
RegHKey=HKEY_CURRENT_USER
RegKey=Control Panel\International
RegValue=sShortTime
Substitute="H":"@","@@":"%H","@":"%#H","h":"@","@@":"%I","@":"%#I","m":"@","@@":"%M","@":"%#M","s":"@","@@":"%S","@":"%#S","tt":"%p"

[MeasureWinShortDateFormat]
Measure=Registry
RegHKey=HKEY_CURRENT_USER
RegKey=Control Panel\International
RegValue=sShortDate
Substitute="y":"@","@@@@@":"%Y","@@@@":"%Y","@@@":"%y","@@":"%y","@":"%#y","M":"@","@@@@":"%b","@@@":"%b","@@":"%m","@":"%#m","d":"@","@@@@":"%A","@@@":"%a","@@":"%d","@":"%#d"

[MeasureCustomTimeFormat]
Measure=String
String=#customTimeFormat#
DynamicVariables=1

[MeasureCustomDateFormat]
Measure=String
String=#customDateFormat#
DynamicVariables=1

; ----- General Weather -----

[MeasureWeatherParent]
Measure=WebParser
URL=http://wxdata.weather.com/wxdata/weather/local/#locationCode#?cc=*&unit=#unitOfMeasure#&dayf=#daysFeed#&locale=#locale#&dayf=7
; URL=file://#CURRENTPATH#WeatherDebug.xml
RegExp=(?siU)^(.*)$
FinishAction=[!EnableMeasureGroup Weather][!UpdateMeasureGroup Weather][!UpdateMeterGroup Weather][!UpdateMeterGroup Background][!Redraw]
UpdateDivider=-1

; Location Info
[MeasureWeatherLocationParent]
Measure=WebParser
URL=[MeasureWeatherParent]
RegExp=#Location#
Group=Weather
Disabled=1

[MeasureWeatherCityName]
Measure=WebParser
URL=[MeasureWeatherLocationParent]
StringIndex=2
Substitute="":"---"
Group=Weather
Disabled=1

[MeasureWeatherLocationLatitude]
Measure=WebParser
URL=[MeasureWeatherLocationParent]
StringIndex=4
Substitute="":"---"
Group=Weather
Disabled=1

[MeasureWeatherLocationLongitude]
Measure=WebParser
URL=[MeasureWeatherLocationParent]
StringIndex=5
Substitute="":"---"
Group=Weather
Disabled=1

[MeasureWeatherLocationTimezoneOffset]
Measure=WebParser
URL=[MeasureWeatherLocationParent]
StringIndex=8
Substitute="":"---"
Group=Weather
Disabled=1

; Units
[MeasureWeatherUnitsParent]
Measure=WebParser
URL=[MeasureWeatherParent]
RegExp=#UnitsOfMeasure#
Group=Weather
Disabled=1

[MeasureWeatherUnitsTemperature]
Measure=WebParser
URL=[MeasureWeatherUnitsParent]
StringIndex=3
Substitute="":"-"
Group=Weather
Disabled=1

[MeasureWeatherUnitsSpeed]
Measure=WebParser
URL=[MeasureWeatherUnitsParent]
StringIndex=5
Substitute="":"-"
Group=Weather
Disabled=1

[MeasureWeatherUnitsDistance]
Measure=WebParser
URL=[MeasureWeatherUnitsParent]
StringIndex=4
Substitute="":"-"
Group=Weather
Disabled=1

[MeasureWeatherUnitsPressure]
Measure=WebParser
URL=[MeasureWeatherUnitsParent]
StringIndex=6
Substitute="":"-"
Group=Weather
Disabled=1

; Other
[MeasureWeatherConditionsParent]
Measure=WebParser
URL=[MeasureWeatherParent]
RegExp=#CurrentConditions#
Group=Weather
Disabled=1

[MeasureWeatherRetrievedTime]
Measure=WebParser
URL=[MeasureWeatherConditionsParent]
StringIndex=1
Substitute="":"---"
Group=Weather
Disabled=1

[MeasureWeatherRetrievedTimeNoTz]
Measure=String
String=[MeasureWeatherRetrievedTime]
Substitute="([^\s]*) (.*) (.*$)":"\1 \2","^$":"---"
RegExpSubstitute=1
DynamicVariables=1
Group=Weather
Disabled=1

[MeasureWeatherRetrievedTimeTz]
Measure=String
String=[MeasureWeatherRetrievedTime]
Substitute="([^\s]*) (.*) (.*$)":"\3"
RegExpSubstitute=1
DynamicVariables=1
Group=Weather
Disabled=1

[MeasureWeatherRetrievedTimeTs]
Measure=Time
TimeStamp=[MeasureWeatherRetrievedTimeNoTz]
TimeStampFormat=%#m/%#d/%y %#I:%M %p
Format=[&Measure[#dateFormat]DateFormat] [&Measure[#timeFormat]TimeFormat]
DynamicVariables=1
Group=Weather
Disabled=1

[MeasureWeatherCurrentDate]
Measure=Time
TimeStamp=[MeasureWeatherRetrievedTimeNoTz]
TimeStampFormat=%#m/%#d/%y %#I:%M %p
Format=[&Measure[#dateFormat]DateFormat]
DynamicVariables=1
Group=Weather
Disabled=1

[MeasureWeatherCurrentNoon]
Measure=Time
TimeStamp=[MeasureWeatherCurrentDate] 12:00
TimeStampFormat=%#m/%#d/%y %#H:%M
Format=[&Measure[#dateFormat]DateFormat] %#H:%M
DynamicVariables=1
Group=Weather
Disabled=1

; ----- Forecast -----

; #region

; - Day 1 -

; General
[MeasureWeatherDay1General]
Measure=WebParser
Url=[MeasureWeatherParent]
RegExp=#Day1General#
Group=Weather
Disabled=1

[MeasureWeatherDay1Weekday]
Measure=WebParser
Url=[MeasureWeatherDay1General]
StringIndex=1
Group=Weather
Disabled=1

[MeasureWeatherDay1Date]
Measure=WebParser
Url=[MeasureWeatherDay1General]
StringIndex=2
Group=Weather
Disabled=1

[MeasureWeatherDay1HiTemp]
Measure=WebParser
Url=[MeasureWeatherDay1General]
StringIndex=3
Group=Weather
Disabled=1

[MeasureWeatherDay1LoTemp]
Measure=WebParser
Url=[MeasureWeatherDay1General]
StringIndex=4
Group=Weather
Disabled=1

[MeasureWeatherDay1SunCalcScript]
Measure=Script
ScriptFile=#scriptPath#SunCalc.lua
IfCondition=1
IfTrueAction=[!CommandMeasure MeasureWeatherDay1SunCalcScript "GenerateData(([MeasureWeatherCurrentNoon:TimeStamp] + (0 * 24 * 60 * 60)), [MeasureWeatherLocationLatitude], [MeasureWeatherLocationLongitude], [MeasureWeatherLocationTimezoneOffset])"]
IfConditionMode=1
UpdateDivider=-1
DynamicVariables=1
Group=Weather
Disabled=1

; Day Conditions
[MeasureWeatherDay1DayConditionsParent]
Measure=WebParser
Url=[MeasureWeatherParent]
RegExp=#Day1DayConditions#
Group=Weather
Disabled=1

[MeasureWeatherDay1DayIcon]
Measure=WebParser
Url=[MeasureWeatherDay1DayConditionsParent]
StringIndex=1
Group=Weather
Disabled=1

[MeasureWeatherDay1DayCondition]
Measure=WebParser
Url=[MeasureWeatherDay1DayConditionsParent]
StringIndex=2
Group=Weather
Disabled=1

; Day Wind
[MeasureWeatherDay1DayWindParent]
Measure=WebParser
Url=[MeasureWeatherParent]
RegExp=#Day1DayWind#
Group=Weather
Disabled=1

[MeasureWeatherDay1DayWindSpeed]
Measure=WebParser
Url=[MeasureWeatherDay1DayWindParent]
StringIndex=1
Group=Weather
Disabled=1

[MeasureWeatherDay1DayWindGustSpeed]
Measure=WebParser
Url=[MeasureWeatherDay1DayWindParent]
StringIndex=2
Group=Weather
Disabled=1

[MeasureWeatherDay1DayWindDirectionDegrees]
Measure=WebParser
Url=[MeasureWeatherDay1DayWindParent]
StringIndex=3
Group=Weather
Disabled=1

[MeasureWeatherDay1DayWindDirectionCompass]
Measure=WebParser
Url=[MeasureWeatherDay1DayWindParent]
StringIndex=4
Group=Weather
Disabled=1

; Day Elements
[MeasureWeatherDay1DayElementsParent]
Measure=WebParser
Url=[MeasureWeatherParent]
RegExp=#Day1DayElements#
Group=Weather
Disabled=1

[MeasureWeatherDay1DayShortCondition]
Measure=WebParser
Url=[MeasureWeatherDay1DayElementsParent]
StringIndex=1
Group=Weather
Disabled=1

[MeasureWeatherDay1DayPrecipitation]
Measure=WebParser
Url=[MeasureWeatherDay1DayElementsParent]
StringIndex=2
Group=Weather
Disabled=1

[MeasureWeatherDay1DayHumidity]
Measure=WebParser
Url=[MeasureWeatherDay1DayElementsParent]
StringIndex=3
Group=Weather
Disabled=1

; Night Conditions
[MeasureWeatherDay1NightConditionsParent]
Measure=WebParser
Url=[MeasureWeatherParent]
RegExp=#Day1NightConditions#
Group=Weather
Disabled=1

[MeasureWeatherDay1NightIcon]
Measure=WebParser
Url=[MeasureWeatherDay1NightConditionsParent]
StringIndex=1
Group=Weather
Disabled=1

[MeasureWeatherDay1NightCondition]
Measure=WebParser
Url=[MeasureWeatherDay1NightConditionsParent]
StringIndex=2
Group=Weather
Disabled=1

; Night Wind
[MeasureWeatherDay1NightWindParent]
Measure=WebParser
Url=[MeasureWeatherParent]
RegExp=#Day1NightWind#
Group=Weather
Disabled=1

[MeasureWeatherDay1NightWindSpeed]
Measure=WebParser
Url=[MeasureWeatherDay1NightWindParent]
StringIndex=1
Group=Weather
Disabled=1

[MeasureWeatherDay1NightWindGustSpeed]
Measure=WebParser
Url=[MeasureWeatherDay1NightWindParent]
StringIndex=2
Group=Weather
Disabled=1

[MeasureWeatherDay1NightWindDirectionDegrees]
Measure=WebParser
Url=[MeasureWeatherDay1NightWindParent]
StringIndex=3
Group=Weather
Disabled=1

[MeasureWeatherDay1NightWindDirectionCompass]
Measure=WebParser
Url=[MeasureWeatherDay1NightWindParent]
StringIndex=4
Group=Weather
Disabled=1

; Night Elements
[MeasureWeatherDay1NightElementsParent]
Measure=WebParser
Url=[MeasureWeatherParent]
RegExp=#Day1NightElements#
Group=Weather
Disabled=1

[MeasureWeatherDay1NightShortCondition]
Measure=WebParser
Url=[MeasureWeatherDay1NightElementsParent]
StringIndex=1
Group=Weather
Disabled=1

[MeasureWeatherDay1NightPrecipitation]
Measure=WebParser
Url=[MeasureWeatherDay1NightElementsParent]
StringIndex=2
Group=Weather
Disabled=1

[MeasureWeatherDay1NightHumidity]
Measure=WebParser
Url=[MeasureWeatherDay1NightElementsParent]
StringIndex=3
Group=Weather
Disabled=1

; Sun
[MeasureWeatherDay1SunriseTime]
Measure=Time
TimeStamp=[&MeasureWeatherDay1SunCalcScript:GetData('sunTimes', 'sunrise')]
Format=[&Measure[#timeFormat]TimeFormat]
DynamicVariables=1
Group=Weather | SunCalc
Disabled=1

[MeasureWeatherDay1SunsetTime]
Measure=Time
TimeStamp=[&MeasureWeatherDay1SunCalcScript:GetData('sunTimes', 'sunset')]
Format=[&Measure[#timeFormat]TimeFormat]
DynamicVariables=1
Group=Weather | SunCalc
Disabled=1

[MeasureWeatherDay1SunAltitude]
Measure=Calc
Formula=max(deg([&MeasureWeatherDay1SunCalcScript:GetScData('getPosition', 'altitude', [&MeasureWeatherDay1SunCalcScript:GetData('sunTimes', 'solarNoon')], [&MeasureWeatherLocationLatitude], [&MeasureWeatherLocationLongitude], [&MeasureWeatherLocationTimezoneOffset])]),0)
MinValue=0
MaxValue=90
DynamicVariables=1
Group=SunCalc
Disabled=1

; Moon
[MeasureWeatherDay1MoonriseTime]
Measure=Time
TimeStamp=[&MeasureWeatherDay1SunCalcScript:GetData('moonTimes', 'rise')]
Format=[&Measure[#timeFormat]TimeFormat]
DynamicVariables=1
Group=Weather | SunCalc
Disabled=1

[MeasureWeatherDay1MoonsetTime]
Measure=Time
TimeStamp=[&MeasureWeatherDay1SunCalcScript:GetData('moonTimes', 'set')]
Format=[&Measure[#timeFormat]TimeFormat]
DynamicVariables=1
Group=Weather | SunCalc
Disabled=1

[MeasureWeatherDay1MoonPhaseCalc]
Measure=Calc
Formula=clamp(abs((#moonInnerRadius# * 4 * (([&MeasureWeatherDay1SunCalcScript:GetData('moonIllumination', 'phase')] > 0.5) ? (0.5 - ([&MeasureWeatherDay1SunCalcScript:GetData('moonIllumination', 'phase')] - 0.5)) : [&MeasureWeatherDay1SunCalcScript:GetData('moonIllumination', 'phase')])) - #moonInnerRadius#),0,#moonInnerRadius#)
DynamicVariables=1
Group=Weather | SunCalc
Disabled=1

[MeasureWeatherDay1MoonLitPercent]
Measure=Calc
Formula=[&MeasureWeatherDay1SunCalcScript:GetData('moonIllumination', 'fraction')]
DynamicVariables=1
Group=Weather | SunCalc
Disabled=1

[MeasureWeatherDay1MoonAltitude]
Measure=Calc
Formula=max(deg([&MeasureWeatherDay1SunCalcScript:GetData('moonPosition', 'altitude')]),0)
MinValue=0
MaxValue=90
DynamicVariables=1
Group=Weather | SunCalc
Disabled=1

; #endregion

; ==================================================
;  METERS
; ==================================================

; ----- Background -----

[MeterBackground]
Meter=Shape
MeterStyle=StyleBackground

[MeterCloseButton]
Meter=Image
MeterStyle=StyleCloseButton

[MeterTitle]
Meter=String
MeterStyle=StyleString | StyleStringConfigTitle
Text=Forecast

; #region

; ----- Day 1 -----

; - Day -

[MeterDay1DayDate]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringConfigSectionHeader | StyleStringDayHeader
MeasureName=MeasureWeatherDay1Weekday
MeasureName2=MeasureWeatherDay1Date
Text=%1, %2

[MeterDay1DayIcon]
Meter=Image
MeterStyle=StyleConditionIcon
ImageName=#imgPath#weather\small_[MeasureWeatherDay1DayIcon].png

[MeterDay1DayCondition]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringCondition
MeasureName=MeasureWeatherDay1DayCondition

[MeterDay1DayHiTemp]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1HiTemp
MeasureName2=MeasureWeatherUnitsTemperature
Text=Hi Temp: %1#deg#%2

[MeterDay1DayPrecipitation]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1DayPrecipitation
Text=Precipitation: %1%

[MeterDay1DayHumidity]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1DayHumidity
Text=Humidity: %1%

[MeterDay1DayWind]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1DayWindSpeed
MeasureName2=MeasureWeatherDay1DayWindGustSpeed
MeasureName3=MeasureWeatherDay1DayWindDirectionDegrees
MeasureName4=MeasureWeatherDay1DayWindDirectionCompass
MeasureName5=MeasureWeatherUnitsSpeed
X=(#contentWidth# / 2)
Y=[MeterDay1DayHiTemp:Y]
Text=Wind: %1 %5 %3#deg# %4
DynamicVariables=1

[MeterDay1DaySunrise]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1SunriseTime
Text=Sunrise: %1
Group=Weather | SunCalc

[MeterDay1DaySunset]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1SunsetTime
Text=Sunset: %1
Group=Weather | SunCalc

[MeterDay1SunMoonAltitudeChart_]
Meter=Shape
MeterStyle=StyleSunMoonAltitudeChart
MoonRotation=Rotate [MeasureWeatherDay1MoonAltitude:],(#chartRadius# + #chartObjectRadius#),(#chartObjectRadius#)
SunRotation=Rotate [MeasureWeatherDay1SunAltitude:],(#chartRadius# + #chartObjectRadius#),(#chartObjectRadius#)
MoonLineRotation=Rotate [MeasureWeatherDay1MoonAltitude:],(#chartRadius#),1
SunLineRotation=Rotate [MeasureWeatherDay1SunAltitude:],(#chartRadius#),1


; - Night -

[MeterDay1NightDate]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringConfigSectionHeader | StyleStringDayHeader
MeasureName=MeasureWeatherDay1Weekday
MeasureName2=MeasureWeatherDay1Date
Text=%1 Night

[MeterDay1NightIcon]
Meter=Image
MeterStyle=StyleConditionIcon
ImageName=#imgPath#weather\small_[MeasureWeatherDay1NightIcon].png

[MeterDay1NightCondition]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringCondition
MeasureName=MeasureWeatherDay1NightCondition

[MeterDay1NightLoTemp]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1LoTemp
MeasureName2=MeasureWeatherUnitsTemperature
Text=Lo Temp: %1#deg#%2

[MeterDay1NightPrecipitation]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1NightPrecipitation
Text=Precipitation: %1%

[MeterDay1NightHumidity]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1NightHumidity
Text=Humidity: %1%

[MeterDay1NightWind]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1NightWindSpeed
MeasureName2=MeasureWeatherDay1NightWindGustSpeed
MeasureName3=MeasureWeatherDay1NightWindDirectionDegrees
MeasureName4=MeasureWeatherDay1NightWindDirectionCompass
MeasureName5=MeasureWeatherUnitsSpeed
X=(#contentWidth# / 2)
Y=[MeterDay1NightLoTemp:Y]
Text=Wind: %1 %5 %3#deg# %4
DynamicVariables=1

[MeterDay1NightMoonrise]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1MoonriseTime
Text=Moonrise: %1
Group=Weather | SunCalc

[MeterDay1NightMoonset]
Meter=String
MeterStyle=StyleString | StyleStringWeather | StyleStringDetail
MeasureName=MeasureWeatherDay1MoonsetTime
Text=Moonset: %1
Group=Weather | SunCalc

[MeterDay1NightMoonShape]
Meter=Shape
MeterStyle=StyleMoonShape
MoonArc=0,#moonInnerRadius# | ArcTo (#moonInnerRadius# * 2),#moonInnerRadius#,#moonInnerRadius#,[MeasureWeatherDay1MoonPhaseCalc:],0,((([&MeasureWeatherDay1SunCalcScript:GetData('moonPhase')] > 0.25) && ([&MeasureWeatherDay1SunCalcScript:GetData('moonPhase')] < 0.75)) ? 1 : 0) | ArcTo 0,#moonInnerRadius#,#moonInnerRadius#,#moonInnerRadius#,0,1
LimbRotation=Rotate ((#showMoonAngle# = 1) ? (-deg([&MeasureWeatherDay1SunCalcScript:GetData('moonIllumination', 'angle')] - [&MeasureWeatherDay1SunCalcScript:GetData('moonPosition', 'parallacticAngle')])) : (([&MeasureWeatherDay1SunCalcScript:GetData('moonIllumination', 'phase')] > 0.5) ? -90 : 90)),#moonInnerRadius#,#moonInnerRadius#
ToolTipTitle=[&MeasureWeatherDay1SunCalcScript:GetData('moonPhaseName')]
ToolTipText=[MeasureWeatherDay1MoonLitPercentCalc:1]% lit
Y=([MeterDay1NightWind:Y] - 1)

; - Divider -

[MeterDay1Divider]
Meter=Image
MeterStyle=StyleHorizontalRule
Y=8R

; #endregion

; ----- Background Height -----

[MeterRetrievedTime]
Meter=String
MeterStyle=StyleString | StyleStringWeather
MeasureName=MeasureWeatherRetrievedTimeTs
MeasureName2=MeasureWeatherRetrievedTimeTz
FontSize=7
FontColor=#colorDim#
FontWeight=400
Text=Updated: %1 %2

[MeterBackgroundHeight]
Meter=Image
MeterStyle=StyleBackgroundHeight
; Y=23R