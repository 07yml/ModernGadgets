[Rainmeter]
Update=-1
AccurateText=1
BackgroundMode=2
OnRefreshAction=[!Move 0 0]
AutoSelectScreen=1
SolidColor=0,0,0,170
SkinWidth=#ScreenAreaWidth#
SkinHeight=#ScreenAreaHeight#

[Metadata]
Name=PermissionRequest
Author=BananaMaster
Information="Requests permission for Rainmeter so keep notifications in the action center."
Version=8.11.2018.2
License=Creative Commons Attribution - Non - Commercial - Share Alike 3.0

[Variables]
@includeStyleSheet=#@#StyleSheet.inc
BackWidth=250
BackHeight=120

[StyleNormal]
FontColor=#colorAccent#
FontSize=10
AntiAlias=1
DynamicVariables=1

[PSRM]
Measure=Plugin
Plugin=PowershellRM
ScriptFile=#@#Scripts\NotificationToaster.ps1

[Background]
Meter=Shape
X=(#ScreenAreaWidth#/2 - #BackWidth#/2)
Y=(#ScreenAreaHeight#/2 - #BackHeight#/2)
Shape=Rectangle 0,0,#BackWidth#,([Allow:Y]+[Allow:H]+16+#BackHeight#/2-#ScreenAreaHeight#/2),8 | Fill Color #colorBg# | Stroke Color #colorBorder#
DynamicVariables=1

[Icon]
Meter=Image
ImageName=#imgPath#notification.png
ImageTint=#colorAccent#
X=16r
Y=16r

[MeterString]
Meter=String
X=16R
Y=r
W=174
MeterStyle=StyleNormal
FontColor=#colorMain#
FontFace=#fontFace#
FontSize=12
InlineSetting=Weight | 700
InlinePattern=Allow(.*$)
InlineSetting2=Weight | 400
InlinePattern2=Rainmeter(.*$)
Text="Allow Rainmeter to show notifications in the action center?"
Clipstring=2

[Deny]
Meter=String
MeterStyle=StyleNormal
X=([Background:X]+[Background:W]-[#CurrentSection#:W]-[Allow:W]-32)
Y=16R
Text="Deny"
LeftMouseUpAction=[!CommandMeasure PSRM "Deactivate-ShowInActionCenter"][!Delay 100][!DeactivateConfig]

[Allow]
Meter=String
MeterStyle=StyleNormal
X=16R
Y=r
Text="Allow"
LeftMouseUpAction=[!CommandMeasure PSRM "Activate-ShowInActionCenter"][!Delay 100][!DeactivateConfig]
